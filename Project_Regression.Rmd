---
title: "Forest Fire Prediction: Regression Task"
author: "SDS322E"
date: "`r format(Sys.Date(), '%B %d, %Y')`"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
---

```{r global_options, include=FALSE}
#DO NOT EDIT THIS CHUNK OR ANYTHING ABOVE IT!
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", warning = F, message = F, tidy=T, tidy.opts=list(width.cutoff=50), R.options=list(max.print=100,dplyr.print_max=100))
```

*Since temperature seems to be negatively correlated with RH (relative humidity) and positively correlated with DC (drought code), we will create a linear regression model to see how well we can predict the area of a forest fire with temperature as the only predictor.*

```{R}
rm(list = ls(all.names = TRUE)) # will clear all objects includes hidden objects.
gc() # free up memory and report the memory usage.
```  

```{R}
library(tidyverse) #always
library(reticulate) # let's R and Python play together

use_python("/usr/bin/python3", required = F)

# do not change these settings
Sys.which("python")
Sys.getenv("DISPLAY") 

matplotlib <- import("matplotlib", convert = TRUE)
matplotlib$use("Agg")
```  
## Python
```{python}
import numpy as np
import matplotlib.pylab as plt
import pandas as pd

forestfires = pd.read_csv('forestfires.csv') 
forestfires.head()
```

```{python}
from sklearn.linear_model import LinearRegression 
from sklearn.linear_model import HuberRegressor 
```


```{python}
X = np.array(forestfires.temp)[:, np.newaxis]
Y = np.array(forestfires.area)

# specify a linear model
lin = LinearRegression()

# fit a linear model to data
lin.fit(X, Y)
```

```{python}
# coeff and intercept
print("[temp, area] Linear Regression Intercept: ", lin.intercept_)

print("[temp, area] Linear Regression Coefficient: ", lin.coef_)
```


```{python}
# plot linear regression--need to fix
plt.plot(X, Y, "o", color = "blue")
m, b = np.polyfit(X, Y, deg = 1)
plt.plot(X, m*X+b, color = "black")
```
```{python}
# Huber Regressor

hub = HuberRegressor()

hub.fit(X, Y)
```
```{python}
# coeff and intercept
print("[temp, area] Huber Regression Intercept: ", hub.intercept_)

print("[temp, area] Huber Regression Coefficient: ", hub.coef_)
```
```{python}
# compare mse
lin_y_pred = lin.predict(X)
hub_y_pred = hub.predict(X)

lin_mse = np.mean((Y - lin_y_pred)**2)
lin_mse

hub_mse = np.mean((Y - hub_y_pred)**2)
hub_mse
```


## R
```{r}
forestfires <- read.csv(file="forestfires.csv")
area.lm <- lm(area ~ temp, data=forestfires)

summary(area.lm)
```

